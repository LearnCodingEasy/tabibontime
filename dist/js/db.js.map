{"version":3,"file":"db.js","sources":["db.js"],"sourcesContent":["\"use strict\";\n\nvar _firebaseFirestore = require(\"https://www.gstatic.com/firebasejs/9.17.2/firebase-firestore.js\");\n// استيراد قاعدة البيانات\n// Import getFirestore : =  Data Base\n\n// استيراد المجموعة\n// Import Collection\n\n// استيراد بيانات المجموعة\n// Import Data Of Collection\n// getDocs\n\n// استيراد كائن في لقطة\n// Import Object onSnapshot\n\n// Object Add Doc استيراد\n// Import Object Add Doc\n\n// Object delete Doc استيراد\n// Import Object delete Doc\n\n// Object Doc استيراد\n// Import Object Doc\n\n// Object Query استيراد\n// Import Object Query\n\n// Object Where استيراد\n// Import Object Where\n\n// Object orderBy استيراد\n// Import Object orderBy\n\n// Object serverTimestamp استيراد\n// Import Object serverTimestamp\n\n// استيراد بيانات عنصر من المجموعة\n// Import Data Of Collection Element\n\n// Object updateDoc استيراد\n// Import Object updateDoc\n\n// لتمكين البيانات المتصلة بالشبكة وغير المتصلة بالشبكة\n// To enable networked and offline data\n\n// init services ( Database )\n// تهيئة خدمات قاعدة بيانات\nvar Database = (0, _firebaseFirestore.getFirestore)();\n// console.log(\"Database: \", Database);\n\n// Get The Collection From Database by Collection Name\n// احصل على المجموعة من قاعدة البيانات حسب اسم المجموعة\n// collection ref\nvar colRef = (0, _firebaseFirestore.collection)(Database, \"collectionName\");\n// console.log(\"colRef: \", colRef);\n\n// Fetching Data\n// جلب البيانات\n// getDocs(colRef)\n//   .then((snapshot) => {\n//     console.log(\"snapshot: \", snapshot.docs);\n//     let items = [];\n//     snapshot.docs.forEach((doc) => {\n//       items.push({ ...doc.data(), id: doc.id });\n//     });\n//     console.log(\"items: \", items);\n//     showItems(items);\n//   })\n//   .catch((err) => {\n//     console.log(err.message);\n//   });\n\n/*\r\n<form class=\"Search\">\r\n    <input type=\"text\" name=\"Title\" id=\"InputSearch\" required />\r\n    <button class=\"btn-search\">Search</button>\r\n</form>\r\n*/\nvar SearchForm = document.querySelector(\".Search\");\nSearchForm.addEventListener(\"submit\", function (e) {\n  e.preventDefault();\n  var inputSearch = document.getElementById(\"InputSearch\");\n  console.log(\"Input Search: \", inputSearch.value);\n});\n\n// استفسارات\n// Queries\nvar queries = (0, _firebaseFirestore.query)(colRef, (0, _firebaseFirestore.orderBy)(\"createdAt\"));\n// const queries = query(colRef, where(\"title\", \"==\", \"Ip\"));\n// const queries = query(colRef, where(\"title\", \"==\", InputSearch.value));\n// const queries = query( colRef, where( \"imgUrl\", \"==\", \"https://images.hdqwalls.com/download/ip-man-4-the-finale-q0-1280x800.jpg\" ) , orderBy('createdAt'));\n// console.log(\"queries: \", queries);\n\n//\n//\nif (\"indexedDB\" in window) {\n  console.log(\"IndexedDB is supported in this browser\");\n  (0, _firebaseFirestore.enableIndexedDbPersistence)(Database)\n  //   // enableIndexedDbPersistence(, { synchronizeTabs: true })\n  //   // enablePersistence(Database)\n  .then(function () {\n    // enable offline data successful\n    // تمكين البيانات غير المتصلة بالإنترنت\n    // تمكين التخزين في IndexedDB بنجاح\n    console.log(\"// Enable Offline Data Successful\");\n  })[\"catch\"](function (err) {\n    if (err.code === \"failed-precondition\") {\n      // لا يمكن تمكين الثبات الفاشل إلا في علامة تبويب واحدة في وقت واحد.\n      console.log(\"failed persistence can only be enabled in one tab at a time.\");\n    } else if (err.code === \"unimplemented\") {\n      // لا يدعم المتصفح الحالي جميع الميزات المطلوبة لتمكين الثبات\n      console.log(\"The current browser does not support all of the features required to enable persistence.\");\n    }\n  });\n} else {\n  // IndexedDB is not supported\n  console.error(\"IndexedDB is not supported in this browser\");\n}\n\n// بيانات جمع الوقت الحقيقي\n// Realtime Collection Data\n// Real-time listener\n// Listen to offline data\n(0, _firebaseFirestore.onSnapshot)(queries, {\n  includeMetadataChanges: true\n}, function (snapshot) {\n  console.log(\"snapshot: \", snapshot.docs);\n  // let items = [];\n  // snapshot.docs.forEach((doc) => {\n  //   items.push({ ...doc.data(), id: doc.id });\n  // });\n  // showItems(items);\n  // console.log(\"items: \", items);\n  // console.log(\"snapshot docChanges(): \", snapshot.docChanges());\n  snapshot.docChanges().forEach(function (change) {\n    // console.log(\"Change: \", change, change.doc.data());\n    if (change.type === \"added\") {\n      // add the document data to the web page\n      console.log(\"New recipe added: \", change.doc.data());\n      showItems(change.doc.data(), change.doc.id);\n    }\n    if (change.type === \"removed\") {\n      // remove the document data from the web page\n      console.log(\"Recipe removed: \", change.doc.data());\n      removeItem(change.doc.id);\n    }\n    var source = snapshot.metadata.fromCache ? \"local cache\" : \"server\";\n    console.log(\"Data came from \" + source);\n  });\n});\n\n// **************\n\n// حدد العنصر\n// Select Element\nvar inner = document.getElementById(\"inner\");\nvar showItems = function showItems(items, id) {\n  // items.forEach((item) => {\n  var title = items.title,\n    description = items.description;\n  var itemEl = document.createElement(\"div\");\n  itemEl.classList.add(\"className\");\n  itemEl.innerHTML = \"\\n    <div class=\\\"card-panel recipe white row\\\" data-id=\\\"\".concat(id, \"\\\">\\n      <img src=\\\"image/dish.png\\\" alt=\\\"recipe thumb\\\">\\n      <div class=\\\"recipe-details\\\">\\n        <div class=\\\"recipe-title\\\">\").concat(title, \"</div>\\n        <div class=\\\"recipe-ingredients\\\">\").concat(description, \"</div>\\n      </div>\\n      <div class=\\\"recipe-delete\\\">\\n        <i class=\\\"material-icons\\\"  data-id=\\\"\").concat(id, \"\\\">delete_outline</i>\\n      </div>\\n    </div>\\n    \");\n  inner.appendChild(itemEl);\n  // });\n};\n// وظيفة لإظهار العناصر\n// Function To Show Items\n// function showItems(items) {\n//   items.forEach((item) => {\n//     const { title, description, id } = item;\n//     let itemEl = document.createElement(\"div\");\n//     itemEl.classList.add(\"className\");\n//     itemEl.innerHTML = `\n\n//     <div class=\"card-panel recipe white row\" data-id=\"${id}\">\n//       <img src=\"image/dish.png\" alt=\"recipe thumb\">\n//       <div class=\"recipe-details\">\n//         <div class=\"recipe-title\">${title}</div>\n//         <div class=\"recipe-ingredients\">${description}</div>\n//       </div>\n//       <div class=\"recipe-delete\">\n//         <i class=\"material-icons\" data-id=\"${id}\">delete_outline</i>\n//       </div>\n//     </div>\n//     `;\n//     inner.appendChild(itemEl);\n//   });\n// }\n// const showItems = (items, id) => {\n//   // items.forEach((item) => {\n//   const { title, description } = items;\n//   let itemEl = document.createElement(\"div\");\n//   itemEl.classList.add(\"className\");\n//   itemEl.innerHTML = `\n//     <div class=\"card-panel recipe white row\" data-id=\"${id}\">\n//       <img src=\"image/dish.png\" alt=\"recipe thumb\">\n//       <div class=\"recipe-details\">\n//         <div class=\"recipe-title\">${title}</div>\n//         <div class=\"recipe-ingredients\">${description}</div>\n//       </div>\n//       <div class=\"recipe-delete\">\n//         <i class=\"material-icons\" data-id=\"${id}\">delete_outline</i>\n//       </div>\n//     </div>\n//     `;\n//   inner.appendChild(itemEl);\n//   // });\n// };\n/*\r\n<form class=\"add\">\r\n    <input type=\"text\" id=\"title\" name=\"'title\" required />\r\n    <input type=\"text\" id=\"description\" name=\"'description\" required />\r\n    <button class=\"btn-add \">Add Item</button>\r\n</form>\r\n*/\n// إضافة عنصر\n// Adding Documents\nvar addItemForm = document.querySelector(\".add\");\naddItemForm.addEventListener(\"submit\", function (e) {\n  e.preventDefault();\n  (0, _firebaseFirestore.addDoc)(colRef, {\n    title: addItemForm.title.value,\n    description: addItemForm.description.value,\n    createdAt: (0, _firebaseFirestore.serverTimestamp)()\n  }).then(function () {\n    addItemForm.reset();\n  })[\"catch\"](function (error) {\n    return console.log(error);\n  });\n});\n\n/*\r\n<form class=\"delete\">\r\n    <input type=\"text\" name=\"id\" id=\"id\" required />\r\n    <button class=\"btn-delete\">Delete Item</button>\r\n</form>\r\n*/\n// حذف عنصر\n// Deleting Documents\n// let deleteItemForm = document.querySelector(\".delete\");\n// deleteItemForm.addEventListener(\"submit\", (e) => {\n//   e.preventDefault();\n//   let colRef = doc(Database, \"collectionName\", deleteItemForm.id.value);\n//   deleteDoc(colRef).then(() => {\n//     deleteItemForm.reset();\n//   });\n// });\n\nvar innerItems = document.querySelector(\".recipes\");\nconsole.log(\"innerItem: \", innerItems);\ninnerItems.addEventListener(\"click\", function (event) {\n  // console.log(\"event: \", event);\n  if (event.target.tagName === \"I\") {\n    // console.log(`Yes`);\n    var id = event.target.getAttribute(\"data-id\");\n    // console.log(\"id: \", id);\n    var _colRef = (0, _firebaseFirestore.doc)(Database, \"collectionName\", id);\n    console.log(\"colRef: \", _colRef);\n    (0, _firebaseFirestore.deleteDoc)(_colRef).then(function () {\n      console.log(\"Item Is Delete\");\n    });\n  }\n});\nvar removeItem = function removeItem(id) {\n  var item = document.querySelector(\".recipe[data-id=\\\"\".concat(id, \"\\\"]\"));\n  item.remove();\n};\n// (GetDoc & RealTime) جلب عنصر واحدة\n// fetching a single document ( getDoc & realtime)\n// const docRef = doc(Database, \"collectionName\", \"hl9vtv3PWok4uXLt0waV\");\n// let singleItem = document.getElementById(`singleItem`);\n// getDoc(docRef).then((doc) => {\n//   console.log(`single document: `, doc.data(), doc.id);\n//   singleItem.innerHTML = showItem(doc.data());\n// });\n// هرجع اشغلها فيها مشكلة\n// onSnapshot(docRef, (doc) => {\n//   console.log(`doc.data() =>`, doc.data());\n//   console.log(`doc.id`, doc.id);\n//   console.log(doc.data(), doc.id);\n//   console.log(`doc.data() =>`, doc.data());\n//   singleItem.innerHTML = showItem(doc.data());\n// });\n\n// وظيفة لإظهار العنصر\n// Function To Show Item\n// function showItem(item) {\n//   const { title, description, id } = item;\n//   let itemEl = document.createElement(\"div\");\n//   itemEl.classList.add(\"className\");\n//   itemEl.innerHTML = `\n//         <div class=\"title\">${title}</div>\n//         <div class=\"title\">${description}</div>\n//         <span class='delete-icon' data-id='${id}'>\n//             <i class=\"fas fa-trash\"></i>\n//         </span>\n//         `;\n//   inner.appendChild(itemEl);\n// }\n\n/*\r\n<form class=\"update\">\r\n    <input type=\"text\" name=\"id\" required />\r\n    <button class=\"btn-update\">Update Item</button>\r\n</form>\r\n*/\n// تحديث عنصر\n// updating a document\nvar updateForm = document.querySelector(\".update\");\nupdateForm.addEventListener(\"submit\", function (e) {\n  e.preventDefault();\n  var docRef = (0, _firebaseFirestore.doc)(Database, \"collectionName\", updateForm.id.value);\n  (0, _firebaseFirestore.updateDoc)(docRef, {\n    title: updateForm.title.value\n  }).then(function () {\n    updateForm.reset();\n  });\n});"],"names":["_firebaseFirestore","require","Database","getFirestore","colRef","collection","SearchForm","document","querySelector","queries","addEventListener","e","preventDefault","inputSearch","getElementById","console","log","value","query","orderBy","inner","window","enableIndexedDbPersistence","then","err","code","error","onSnapshot","includeMetadataChanges","snapshot","docs","docChanges","forEach","change","type","doc","data","showItems","id","removeItem","source","metadata","fromCache","items","title","description","itemEl","createElement","classList","add","innerHTML","concat","appendChild","addItemForm","innerItems","addDoc","createdAt","serverTimestamp","reset","event","target","tagName","getAttribute","_colRef","deleteDoc","remove","updateForm","docRef","updateDoc"],"mappings":"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"}